<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/queue.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/queue.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import wwebjs from 'whatsapp-web.js';
import { makeSticker, makeStickerText } from '../services/functions/sticker.js';

/**
 * Sticker queue
 * @type {Map&lt;wwebjs.MessageId, wwebjs.Message>}
 */
const stickerQueue = new Map();
setInterval(() => {
    if (stickerQueue.size > 0) {
        const firstKey = stickerQueue.keys().next();
        const firstItem = stickerQueue.get(firstKey.value);

        // get every other message from the same chat (msg.from)
        const chat = firstItem.from;
        const chatMessages = [...stickerQueue.values()].filter(msg => msg.from === chat);

        // move every message from the same chat to the end of the queue
        chatMessages.forEach(msg => {
            stickerQueue.delete(msg.id);
            stickerQueue.set(msg.id, msg);
        });

        stickerQueue.delete(firstKey.value);
        makeSticker(firstItem, true);
        makeSticker(firstItem, false);
    }
}, 1000);

/**
 * Sticker text queue
 * @type {Map&lt;string, wwebjs.Message>}
 */
const stickerTextQueue = new Map();
setInterval(() => {
    if (stickerTextQueue.size > 0) {
        const firstKey = stickerTextQueue.keys().next();
        const firstItem = stickerTextQueue.get(firstKey.value);

        // get every other message from the same chat (msg.from)
        const chat = firstItem.from;
        const chatMessages = [...stickerQueue.values()].filter(msg => msg.from === chat);

        // move every message from the same chat to the end of the queue
        chatMessages.forEach(msg => {
            stickerQueue.delete(msg.id);
            stickerQueue.set(msg.id, msg);
        });

        stickerTextQueue.delete(firstKey.value);
        makeStickerText(firstItem);
    }
}, 1000);

export { stickerQueue, stickerTextQueue };</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Util.html">Util</a></li></ul><h3>Global</h3><ul><li><a href="global.html#client">client</a></li><li><a href="global.html#getClient">getClient</a></li><li><a href="global.html#makeSticker">makeSticker</a></li><li><a href="global.html#makeStickerText">makeStickerText</a></li><li><a href="global.html#stickerQueue">stickerQueue</a></li><li><a href="global.html#stickerTextQueue">stickerTextQueue</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Sun Jul 23 2023 03:07:54 GMT-0300 (Horário Padrão de Brasília)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
